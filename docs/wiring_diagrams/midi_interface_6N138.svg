<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="900" viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .component { fill: #444; stroke: #888; stroke-width: 3; }
      .ic { fill: #222; stroke: #666; stroke-width: 3; }
      .resistor { fill: #DEB887; stroke: #8B7355; stroke-width: 2; }
      .wire { fill: none; stroke-width: 4; }
      .power { stroke: #ff0000; stroke-width: 5; }
      .ground { stroke: #000000; stroke-width: 5; }
      .signal { stroke: #00ff00; stroke-width: 4; }
      .midi { stroke: #ffaa00; stroke-width: 4; }
      text { fill: #fff; font-size: 16px; font-family: Arial, sans-serif; font-weight: bold; }
      .label { font-size: 24px; font-weight: bold; }
      .title { font-size: 32px; font-weight: bold; fill: #ff3333; }
      .pin-label { font-size: 14px; fill: #ccc; }
      .value { fill: #ffff00; font-weight: bold; font-size: 18px; }
      .section-title { font-size: 20px; fill: #00ffff; font-weight: bold; }
    </style>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="900" fill="#222"/>
  
  <!-- Title -->
  <text x="700" y="40" text-anchor="middle" class="title">MIDI Interface Circuit - 6N138 Optocoupler</text>
  <text x="700" y="70" text-anchor="middle" class="label">Standard MIDI 1.0 Electrical Specification</text>
  
  <!-- MIDI Input Section -->
  <text x="200" y="120" text-anchor="middle" class="section-title">MIDI INPUT (Optoisolated)</text>
  
  <!-- MIDI DIN Socket (Input) -->
  <circle cx="120" cy="180" r="50" class="component"/>
  <text x="120" y="110" text-anchor="middle" class="label">DIN-5 Female</text>
  <text x="120" y="135" text-anchor="middle" class="label">MIDI IN Socket</text>
  
  <!-- Pin numbers on DIN socket -->
  <circle cx="120" cy="155" r="5" fill="#fff"/>
  <circle cx="140" cy="170" r="5" fill="#fff"/>
  <circle cx="140" cy="190" r="5" fill="#fff"/>
  <circle cx="100" cy="170" r="5" fill="#fff"/>
  <circle cx="100" cy="190" r="5" fill="#fff"/>
  
  <text x="110" y="150" class="pin-label">2</text>
  <text x="150" y="175" class="pin-label">4</text>
  <text x="150" y="195" class="pin-label">5</text>
  <text x="85" y="175" class="pin-label">1</text>
  <text x="85" y="195" class="pin-label">3</text>
  
  <!-- 220Ω Resistors for MIDI Input -->
  <rect class="resistor" x="220" y="160" width="60" height="12" rx="6"/>
  <text x="250" y="170" text-anchor="middle" class="value">220Ω</text>
  <text x="250" y="150" text-anchor="middle" class="pin-label">R1</text>
  
  <rect class="resistor" x="220" y="190" width="60" height="12" rx="6"/>
  <text x="250" y="200" text-anchor="middle" class="value">220Ω</text>
  <text x="250" y="210" text-anchor="middle" class="pin-label">R2</text>
  
  <!-- 6N138 Optocoupler -->
  <rect class="ic" x="350" y="140" width="120" height="120" rx="10"/>
  <text x="410" y="120" text-anchor="middle" class="label">6N138</text>
  <text x="410" y="200" text-anchor="middle" class="label">Optocoupler</text>
  <text x="410" y="220" text-anchor="middle" class="pin-label">High Speed</text>
  
  <!-- 6N138 Pin Diagram with proper DIP-8 layout -->
  <text x="340" y="160" text-anchor="end" class="pin-label">2 (Anode)</text>
  <text x="340" y="180" text-anchor="end" class="pin-label">3 (Cathode)</text>
  <text x="340" y="200" text-anchor="end" class="pin-label">4 (NC)</text>
  <text x="340" y="220" text-anchor="end" class="pin-label">5 (Gnd)</text>
  
  <text x="480" y="160" text-anchor="start" class="pin-label">7 (NC)</text>
  <text x="480" y="180" text-anchor="start" class="pin-label">6 (Output)</text>
  <text x="480" y="200" text-anchor="start" class="pin-label">5 (Gnd)</text>
  <text x="480" y="220" text-anchor="start" class="pin-label">8 (+5V)</text>
  
  <!-- Pin circles for 6N138 -->
  <circle cx="350" cy="155" r="5" fill="#fff"/>  <!-- Pin 2 -->
  <circle cx="350" cy="175" r="5" fill="#fff"/>  <!-- Pin 3 -->
  <circle cx="350" cy="195" r="5" fill="#fff"/>  <!-- Pin 4 -->
  <circle cx="350" cy="215" r="5" fill="#fff"/>  <!-- Pin 5 -->
  
  <circle cx="470" cy="155" r="5" fill="#fff"/>  <!-- Pin 7 -->
  <circle cx="470" cy="175" r="5" fill="#fff"/>  <!-- Pin 6 -->
  <circle cx="470" cy="195" r="5" fill="#fff"/>  <!-- Pin 5 -->
  <circle cx="470" cy="215" r="5" fill="#fff"/>  <!-- Pin 8 -->
  
  <!-- 4.7kΩ Pull-up Resistor -->
  <rect class="resistor" x="520" y="160" width="12" height="40" rx="6"/>
  <text x="550" y="180" class="value">4.7kΩ</text>
  <text x="550" y="195" class="pin-label">Pull-up</text>
  
  <!-- MIDI Input Wiring -->
  <line class="midi" x1="140" y1="170" x2="220" y2="166"/>   <!-- DIN Pin 4 to R1 -->
  <line class="midi" x1="140" y1="190" x2="220" y2="196"/>   <!-- DIN Pin 5 to R2 -->
  <line class="midi" x1="280" y1="166" x2="350" y2="155"/>   <!-- R1 to 6N138 Pin 2 -->
  <line class="midi" x1="280" y1="196" x2="350" y2="175"/>   <!-- R2 to 6N138 Pin 3 -->
  
  <!-- Power connections for 6N138 -->
  <line class="power" x1="470" y1="215" x2="526" y2="215"/>   <!-- Pin 8 to +5V -->
  <line class="power" x1="526" y1="215" x2="526" y2="160"/>   <!-- +5V line -->
  <line class="power" x1="526" y1="160" x2="580" y2="160"/>   <!-- To supply -->
  <line class="signal" x1="470" y1="175" x2="620" y2="175"/>  <!-- Output to Arduino A4 -->
  <line class="ground" x1="470" y1="195" x2="520" y2="195"/>  <!-- Pin 5 to GND -->
  <line class="ground" x1="520" y1="195" x2="580" y2="195"/>  <!-- GND line -->
  
  <!-- MIDI Output Section -->
  <text x="900" y="120" text-anchor="middle" class="section-title">MIDI OUTPUT (Standard)</text>
  
  <!-- MIDI DIN Socket (Output) -->
  <circle cx="1020" cy="180" r="50" class="component"/>
  <text x="1020" y="110" text-anchor="middle" class="label">DIN-5 Female</text>
  <text x="1020" y="135" text-anchor="middle" class="label">MIDI OUT Socket</text>
  
  <!-- Pin numbers on output DIN socket -->
  <circle cx="1020" cy="155" r="5" fill="#fff"/>
  <circle cx="1040" cy="170" r="5" fill="#fff"/>
  <circle cx="1040" cy="190" r="5" fill="#fff"/>
  <circle cx="1000" cy="170" r="5" fill="#fff"/>
  <circle cx="1000" cy="190" r="5" fill="#fff"/>
  
  <text x="1010" y="150" class="pin-label">2</text>
  <text x="1050" y="175" class="pin-label">4</text>
  <text x="1050" y="195" class="pin-label">5</text>
  <text x="985" y="175" class="pin-label">1</text>
  <text x="985" y="195" class="pin-label">3</text>
  
  <!-- 220Ω Resistor for MIDI Output -->
  <rect class="resistor" x="820" y="185" width="60" height="12" rx="6"/>
  <text x="850" y="195" text-anchor="middle" class="value">220Ω</text>
  <text x="850" y="175" text-anchor="middle" class="pin-label">R3</text>
  
  <!-- MIDI Output Wiring -->
  <line class="signal" x1="720" y1="191" x2="820" y2="191"/>   <!-- Arduino A5 to resistor -->
  <line class="midi" x1="880" y1="191" x2="1040" y2="190"/>    <!-- Resistor to DIN Pin 5 -->
  <line class="power" x1="1040" y1="170" x2="1100" y2="170"/>  <!-- DIN Pin 4 to +5V -->
  <line class="power" x1="1100" y1="170" x2="1100" y2="140"/>  <!-- +5V line -->
  
  <!-- Arduino Connection Labels -->
  <text x="620" y="165" class="label">To Arduino A4</text>
  <text x="620" y="185" class="label">(MIDI RX)</text>
  <text x="720" y="175" class="label">From Arduino A5</text>
  <text x="720" y="195" class="label">(MIDI TX)</text>
  
  <!-- Power Supply Labels -->
  <text x="590" y="155" class="value">+5V</text>
  <text x="590" y="205" class="value">GND</text>
  <text x="1110" y="135" class="value">+5V</text>
  
  <!-- Current Loop Indication -->
  <text x="120" y="260" text-anchor="middle" class="label">MIDI Current Loop</text>
  <text x="120" y="280" text-anchor="middle" class="pin-label">5mA nominal</text>
  
  <!-- Isolation Barrier -->
  <line stroke="#ffff00" stroke-width="3" stroke-dasharray="10,5" x1="330" y1="100" x2="330" y2="280"/>
  <text x="340" y="290" class="value">ISOLATION BARRIER</text>
  
  <!-- Circuit Schematic Section -->
  <rect fill="#333" stroke="#666" stroke-width="3" x="50" y="350" width="1300" height="500" rx="10"/>
  <text x="70" y="380" class="label" fill="#ff3333">MIDI Interface Implementation Details:</text>
  
  <!-- MIDI Input Schematic -->
  <text x="70" y="420" class="section-title">MIDI INPUT Circuit:</text>
  
  <!-- Schematic symbols for input -->
  <circle cx="150" cy="450" r="25" class="component"/>
  <text x="150" y="455" text-anchor="middle" class="pin-label">DIN-5</text>
  
  <rect class="resistor" x="220" y="440" width="40" height="8" rx="4"/>
  <text x="240" y="450" text-anchor="middle" class="pin-label">220Ω</text>
  
  <rect class="resistor" x="220" y="460" width="40" height="8" rx="4"/>
  <text x="240" y="470" text-anchor="middle" class="pin-label">220Ω</text>
  
  <rect class="ic" x="300" y="430" width="60" height="40" rx="5"/>
  <text x="330" y="450" text-anchor="middle" class="pin-label">6N138</text>
  
  <rect class="resistor" x="400" y="440" width="8" height="20" rx="2"/>
  <text x="420" y="450" text-anchor="middle" class="pin-label">4.7k</text>
  
  <!-- Connection lines for schematic -->
  <line class="midi" x1="175" y1="445" x2="220" y2="444"/>
  <line class="midi" x1="175" y1="455" x2="220" y2="464"/>
  <line class="midi" x1="260" y1="444" x2="300" y2="440"/>
  <line class="midi" x1="260" y1="464" x2="300" y2="450"/>
  <line class="signal" x1="360" y1="445" x2="400" y2="445"/>
  <line class="signal" x1="408" y1="445" x2="450" y2="445"/>
  <line class="power" x1="408" y1="440" x2="408" y2="420"/>
  <line class="ground" x1="330" y1="470" x2="330" y2="490"/>
  
  <text x="460" y="450" class="value">To Arduino A4</text>
  <text x="415" y="415" class="value">+5V</text>
  <text x="340" y="505" class="value">GND</text>
  
  <!-- MIDI Output Schematic -->
  <text x="70" y="550" class="section-title">MIDI OUTPUT Circuit:</text>
  
  <text x="150" y="580" class="value">From Arduino A5</text>
  <rect class="resistor" x="280" y="575" width="40" height="8" rx="4"/>
  <text x="300" y="585" text-anchor="middle" class="pin-label">220Ω</text>
  <circle cx="380" cy="580" r="25" class="component"/>
  <text x="380" y="585" text-anchor="middle" class="pin-label">DIN-5</text>
  
  <line class="signal" x1="220" y1="579" x2="280" y2="579"/>
  <line class="midi" x1="320" y1="579" x2="355" y2="579"/>
  <line class="power" x1="380" y1="555" x2="380" y2="535"/>
  <text x="385" y="530" class="value">+5V</text>
  
  <!-- Component Specifications -->
  <text x="70" y="650" class="section-title">Component Specifications:</text>
  
  <text x="90" y="680" class="value">6N138 Optocoupler:</text>
  <text x="110" y="700" fill="#fff">• High-speed optocoupler (10 Mbit/s)</text>
  <text x="110" y="720" fill="#fff">• DIP-8 package, TTL compatible output</text>
  <text x="110" y="740" fill="#fff">• Alternatives: H11L1, PC900V, 6N137</text>
  <text x="110" y="760" fill="#fff">• Operating voltage: 4.5V to 5.5V</text>
  
  <text x="500" y="680" class="value">Resistors (1/4W, 5%):</text>
  <text x="520" y="700" fill="#fff">• 2× 220Ω (MIDI current limiting)</text>
  <text x="520" y="720" fill="#fff">• 1× 4.7kΩ (pull-up resistor)</text>
  <text x="520" y="740" fill="#fff">• Metal film recommended for stability</text>
  
  <text x="850" y="680" class="value">DIN Connectors:</text>
  <text x="870" y="700" fill="#fff">• DIN-5 female, 180° sockets</text>
  <text x="870" y="720" fill="#fff">• Panel mount, solder terminals</text>
  <text x="870" y="740" fill="#fff">• Standard MIDI pinout (4,5 used)</text>
  
  <!-- Connection Details -->
  <text x="70" y="800" class="section-title">Connection Details:</text>
  
  <text x="90" y="830" class="value">MIDI IN Connections:</text>
  <text x="110" y="850" fill="#fff">DIN Pin 4 → 220Ω → 6N138 Pin 2 (Anode)</text>
  <text x="110" y="870" fill="#fff">DIN Pin 5 → 220Ω → 6N138 Pin 3 (Cathode)</text>
  <text x="110" y="890" fill="#fff">6N138 Pin 6 → 4.7kΩ → +5V AND → Arduino A4</text>
  <text x="110" y="910" fill="#fff">6N138 Pin 8 → +5V, Pin 5 → GND</text>
  
  <text x="700" y="830" class="value">MIDI OUT Connections:</text>
  <text x="720" y="850" fill="#fff">Arduino A5 → 220Ω → DIN Pin 5</text>
  <text x="720" y="870" fill="#fff">+5V → DIN Pin 4</text>
  <text x="720" y="890" fill="#fff">DIN Pins 1, 2, 3 not connected</text>
  
  <!-- Notes -->
  <text x="70" y="950" class="section-title">Important Notes:</text>
  <text x="90" y="970" fill="#fff">• This circuit provides complete electrical isolation between MIDI devices</text>
  <text x="90" y="990" fill="#fff">• Standard MIDI baud rate: 31,250 bps (8-N-1 format)</text>
  <text x="90" y="1010" fill="#fff">• Current loop: 5mA nominal, 2mA minimum for proper operation</text>
  <text x="90" y="1030" fill="#fff">• Use shielded cable for long MIDI runs to prevent interference</text>
</svg>